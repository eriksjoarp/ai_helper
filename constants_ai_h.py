import pathlib
import os
from os.path import join as j

BASE_DIR_AI = r'C:\ai'
BASE_DIR_PROJ = pathlib.Path(os.getcwd())
BASE_DIR_GIT = BASE_DIR_PROJ.parent.absolute()
BASE_DIR_EXPERIMENTS = r'C:\ai_experiments'
BASE_DIR_RESULTS = j(BASE_DIR_AI, 'results')

# dataset directory
DIR_EXPERIMENTS_SWIN = j(BASE_DIR_EXPERIMENTS, 'swin')

DIR_AI_HELPER = j(BASE_DIR_GIT, 'ai_helper')
DIR_HELPER = j(BASE_DIR_GIT, 'helper')

DIR_DATASETS = j(BASE_DIR_AI, 'datasets')
DIR_DATASETS_LARGE = r'D:\ai\datasets'  #ToDo on another drive
DIR_MODELS_SAVE = j(BASE_DIR_EXPERIMENTS, 'models_saved')
DIR_LOGS = j(BASE_DIR_EXPERIMENTS, 'logs')
DIR_RESULTS = j(BASE_DIR_EXPERIMENTS, 'results')

DIR_CONFIGS = j(BASE_DIR_EXPERIMENTS, 'configs')
DIR_CONFIGS_SWIN = j(DIR_CONFIGS, 'swin')

DIR_AUGMENT_CONFIGS = j(DIR_CONFIGS, 'augment_configs')
DIR_CONFIGS_EXPERIMENTS_TO_RUN = j(DIR_CONFIGS, 'experiments_to_run')
DIR_CONFIGS_DEFAULTS = j(DIR_CONFIGS, 'configs_default')

DIR_CONFIGS_RUN = j(DIR_CONFIGS_EXPERIMENTS_TO_RUN, 'experiments_run')
DIR_LOCAL_FIGS = j(os.getcwd(), 'figs')

DIR_MODELS = j(BASE_DIR_AI, 'models')
DIR_MODEL_CACHE = j(DIR_MODELS, 'model_cache')


'''
experiments folder: running number plus
config
result
log
model_saved
'''

RANDOM_STATE = 42

# datasets
MNIST_NUMBERS = 0

# train
doTrain = True
noTrain = False
NONE = None
EMPTY = 'EMPTY'

# experiment
LOGFILE_NAME = 'LOGFILE_NAME'
EXPERIMENT_SEED = 'EXPERIMENT_SEED'
LR_INCREASE = 'LR_INCREASE'
LR_FACTOR = 'LR_FACTOR'

# model
MODEL_TYPE = 'MODEL_TYPE'
MODEL_NAME = 'MODEL_NAME'
BATCH_SIZE = 'BATCH_SIZE'
EPOCHS = 'EPOCHS'
LR = 'LR'
START_TIME = 'START_TIME'
EPOCH = 'EPOCH'

MODEL_TYPE_CNN = 'MODEL_TYPE_CNN'
MODEL_TYPE_CLUSTERING = 'MODEL_TYPE_CLUSTERING'
MODEL_TYPE_ML = 'MODEL_TYPE_ML'

MODEL_OUTPUT_LAYER_TYPE = 'MODEL_OUTPUT_LAYER_TYPE'
MODEL_OUTPUT_LAYER_TYPE_LINEAR = 'MODEL_OUTPUT_LAYER_TYPE_LINEAR'
MODEL_OUTPUT_LAYER_TYPE_SIGMOID = 'MODEL_OUTPUT_LAYER_TYPE_SIGMOID'

MODEL_MOBILENET_V3 = 'MODEL_MOBILENET_V3'
MODEL_RESNET = 'MODEL_RESNET'

# transforms
AUGMENT = 'AUGMENT'
AUGMENT_CONFIG = 'AUGMENT_CONFIG'
AUGMENT_RESIZE = 'AUGMENT_RESIZE'
AUGMENT_CROP = 'AUGMENT_CROP'
AUGMENT_RANDAUGMENT = 'AUGMENT_RANDAUGMENT'
AUGMENT_NONE = 'AUGMENT_NONE'

# pytorch
NUM_WORKERS = 'NUM_WORKERS'
PIN_MEMORY = 'PIN_MEMORY'
CUDNN_BENCHMARK = 'CUDNN_BENCHMARK'
RANDOM_SEED_VALUE = 17
RANDOM_SEED = 'RANDOM_SEED'
DEVICE = 'DEVICE'
DEVICE_0 = 'cuda:0'
DEVICE_1 = 'cuda:1'
DEVICE_2 = 'cuda:2'

MODEL_NAME_BEST_OLD = 'MODEL_NAME_BEST_OLD'
LOGFILE = 'LOGFILE'

# optimizer
OPTIMIZER = 'OPTIMIZER'
OPTIMIZER_ADAM = 'OPTIMIZER_ADAM'
OPTIMIZER_ADAMW = 'OPTIMIZER_ADAMW'
OPTIMIZER_BETA1 = 'OPTIMIZER_BETA1'
OPTIMIZER_BETA2 = 'OPTIMIZER_BETA2'
OPTIMIZER_WEIGHT_DECAY = 'OPTIMIZER_WEIGHT_DECAY'

# loss functions
CRITERION = 'CRITERION'
CRITERION_CROSS_ENTROPY = 'CRITERION_CROSS_ENTROPY'
LOSS_DECAY = 'LOSS_DECAY'

# data
DATASET_NAME = 'DATASET_NAME'
DATASET_TYPE = 'DATASET_TYPE'
DATASET_SOURCE = 'DATASET_SOURCE'

TRAIN_DS = 'TRAIN_DS'
VAL_DS = 'VAL_DS'
TEST_DS = 'TEST_DS'
TRAIN_DL = 'TRAIN_DL'
VAL_DL = 'VAL_DL'
TEST_DL = 'TEST_DL'
TRAIN_TRANSFORM = 'TRAIN_TRANSFORM'
VAL_TRANSFORM = 'VAL_TRANSFORM'
TEST_TRANSFORM = 'TEST_TRANSFORM'

# results
ACC_BEST = 'ACC_BEST'
ACC_BEST_EPOCHE = 'ACC_BEST_EPOCHE'

# torchvision models
MODEL_IS_FC_TYPE = 'MODEL_IS_FC_TYPE'
MODEL_IS_CLASSIFIER_TYPE = 'MODEL_IS_CLASSIFIER_TYPE'
MODEL_IS_CLASSIFIER_DEEP_TYPE = 'MODEL_IS_CLASSIFIER_DEEP_TYPE'
MODEL_TYPE_UNKNOWN = 'MODEL_TYPE_UNKNOWN'

MODEL_TORCHVISION_FC_TYPES = [
    'GoogLeNet',
    'Inception3',
    'RegNet',
    'ShuffleNetV2',
    'ResNet',
    'ResNext'
]
MODEL_TORCHVISION_CLASSIFIER_TYPES = [
    'DenseNet',
    'NoNet'
]
MODEL_TORCHVISION_CLASSIFIER_DEEP_TYPES = [
    'AlexNet',
    'ConvNeXt',
    'EfficientNet',
    'MNASNet',
    'MobileNetV2',
    'MobileNetV3',
    'SqueezeNet',
    'VGG'
]

MODELS_TORCHVISION = [
    MODEL_TORCHVISION_FC_TYPES,
    MODEL_TORCHVISION_CLASSIFIER_TYPES,
    MODEL_TORCHVISION_CLASSIFIER_DEEP_TYPES
]

############################################                PROJECTS            #########################################
DIR_PROJECT_SR3 = os.path.join(BASE_DIR_GIT, 'sr3')
PROJ_SR3_ARG_SIZE_16_64 = r'''--size 16,128'''
PROJ_SR3_ARG_SIZE_64_512 = r'''--size 64,512'''

############################################                CONFIGS             #########################################
DIR_CONFIGS_SR3_BASE = os.path.join(DIR_PROJECT_SR3, 'config')
DIR_RESULTS_SR3 = os.path.join(BASE_DIR_RESULTS, 'sr3')
DIR_CONFIGS_SR3 = os.path.join(DIR_RESULTS_SR3, 'configs')

CONFIG_SR_SR3_16_128_JSON = os.path.join(DIR_CONFIGS_SR3_BASE, 'sr_sr3_16_128.json')
CONFIG_SR_SR3_64_512_JSON = os.path.join(DIR_CONFIGS_SR3_BASE, 'sr_sr3_64_512.json')
CONFIG_SR_DDPM_16_128_JSON = os.path.join(DIR_CONFIGS_SR3_BASE, 'sr_ddpm_16_128.json')
CONFIG_SAMPLE_SR3_128_JSON = os.path.join(DIR_CONFIGS_SR3_BASE, 'sample_sr3_128.json')
CONFIG_SAMPLE_DDPM_128_JSON = os.path.join(DIR_CONFIGS_SR3_BASE, 'sample_ddpm_128.json')


# others



